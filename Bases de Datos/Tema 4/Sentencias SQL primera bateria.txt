Consultas con expresiones aritméticas y predicados básicos. Consultas básicas de
producto cartesiano y join.
Relación de Ejercicios 1.
1. Hallar por orden alfabético los nombres de los departamentos cuyo director está en funciones.
SELECT NOMDE 
FROM tdepto 
WHERE TIDIR = 'F' 
ORDER BY NOMDE;


2. Obtener un listín telefónico de los empleados del departamento 121 incluyendo nombre del empleado,
número del empleado y extensión telefónica. Por orden alfabético descendente.
SELECT NOMEM, NUMEM, EXTEL
FROM temple
WHERE NUMDE = 121
ORDER BY NOMEM DESC;


3. Obtener por orden creciente una relación de todos los números de extensiones telefónicas de los
empleados (elimina las repeticiones).
SELECT DISTINCT EXTEL 
FROM temple
ORDER BY EXTEL ASC;


4. Hallar el nombre, salario y la comisión de los empleados con más de un hijo, clasificados por comisión, y
dentro de la comisión por orden alfabético. El listado debe incluir también los empleados con más de un hijo
aunque no tengan comisión. Utilizar la función ISNULL para que cuando la comisión NULL muestre un 0.
Utiliza alias para los nombres de las columnas.
SELECT NOMEM AS Nombre, SALAR AS Salario, ISNULL(COMIS, 0) AS Comision
FROM temple
WHERE NUMHI > 1
ORDER BY Comision, NOMEM;


5. Obtener salario y nombre de los empleados con dos hijos por orden decreciente de salario y por orden
alfabético dentro del salario.
SELECT SALAR, NOMEM
FROM temple
WHERE NUMHI = 2
ORDER BY SALAR DESC, NOMEM;


6. Obtener el nombre de los empleados cuya comisión es superior o igual al 50% de su salario, por orden
alfabético.
SELECT NOMEM 
FROM temple
WHERE COMIS >= SALAR * 0.50
ORDER BY NOMEM;


7. A. En una campaña de ayuda familiar se ha decidido dar a los empleados una paga extra de 30 euros por
hijo, a partir del tercero inclusive. Obtener por orden alfabético para estos empleados: nombre y salario total
que van a cobrar incluyendo esta paga extra.
SELECT NOMEM, (SALAR + (NUMHI - 2) * 30)
FROM temple
WHERE NUMHI >= 3
ORDER BY NOMEM;


8. Igual que el ejercicio anterior, pero mostrar también el nombre y el salario que ganan el resto de los
empleados (los que tienen 0, 1 o 2 hijos). Resuelve el ejercicio de dos formas diferentes: con el operador
UNION y con una expresión CASE. Consulta en el Manual SQL w3schools “SQL Union” y “SQL Case”.
SELECT NOMEM AS Nombre, (SALAR + (NUMHI - 2) * 30) AS SalarioTotal
FROM temple
WHERE NUMHI >= 3
UNION
SELECT NOMEM AS Nombre, SALAR AS SalarioTotal
FROM temple
WHERE NUMHI < 3
ORDER BY Nombre;
